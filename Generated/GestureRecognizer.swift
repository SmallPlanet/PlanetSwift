//
// Autogenerated by gaxb at 05:04:35 PM on 02/19/15
//

import UIKit

public class GestureRecognizer: GestureRecognizerBase {
	
	public var recognizer:UIGestureRecognizer?
	private lazy var helper = GestureRecognizerHelper()
	
	public override func gaxbPrepare() {
		super.gaxbPrepare()
		
		if let recognizer = recognizer {
			
			if let cancelsTouchesInView = cancelsTouchesInView {
				recognizer.cancelsTouchesInView = cancelsTouchesInView
			}
			if let delaysTouchesBegan = delaysTouchesBegan {
				recognizer.delaysTouchesBegan = delaysTouchesBegan
			}
			if let delaysTouchesEnded = delaysTouchesEnded {
				recognizer.delaysTouchesEnded = delaysTouchesEnded
			}
			
			if let _ = onStateChange {
				helper.delegate = self
				recognizer.addTarget(helper, action: #selector(GestureRecognizerHelper.recognizerStateDidChange(_:)))
			}
		}
	}
	
	public override func gaxbDidPrepare() {
		super.gaxbDidPrepare()
		
		if let recognizer = recognizer,
            let view = view,
            let scope = scope() as? Object,
            let referencedView = scope.objectForId(view) as? View {
			referencedView.view.addGestureRecognizer(recognizer)
		}
	}
	
	func recognizerStateDidChange(_ recognizer:UIGestureRecognizer) {
		if let onStateChange = onStateChange {
			let (scopeObject, name) = self.parseNotification(onStateChange)
			if let name = name {
				NotificationCenter.`default`.post(name: Foundation.Notification.Name(rawValue: name), object: scopeObject)
			}
		}
	}
}

class GestureRecognizerHelper: NSObject {
	weak var delegate: GestureRecognizer?
	
    @objc func recognizerStateDidChange(_ recognizer:UIGestureRecognizer) {
		delegate?.recognizerStateDidChange(recognizer)
	}
}
